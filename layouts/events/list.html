{{ define "main" }}

<div class="page-hero page-hero--pink">
  <div class="container">
    <h1 class="page-hero__title">Events</h1>
    <p class="page-hero__desc">Game jams, talks, social catch-ups, and more. Everyone is welcome.</p>
    <div style="display: flex; flex-wrap: wrap; gap: var(--space-sm); margin-top: var(--space-md);">
      <a href="webcal://tasgamemakers.com/events/calendar.ics" class="btn-new btn-new--white">Subscribe to Calendar</a>
      <a href="https://calendar.google.com/calendar/r?cid=webcal%3A%2F%2Ftasgamemakers.com%2Fevents%2Fcalendar.ics" class="btn-new btn-new--outline" target="_blank" rel="noopener">Add to Google Calendar</a>
    </div>
  </div>
</div>

<div class="page-content">
  <div class="container">

    {{ $now := now }}
    {{ $upcoming := where (where .Pages ".Date" "ge" $now) ".Params.unlisted" "ne" true }}
    {{ $past := where (where .Pages ".Date" "lt" $now) ".Params.unlisted" "ne" true }}

    <section class="events-list-section">
      <h2>Upcoming Events</h2>
      {{ if $upcoming }}
        {{ range $upcoming.GroupByDate "January 2006" "asc" }}
        <div class="events-month">
          <h3 class="events-month__title">{{ .Key }}</h3>
          <div class="events-grid">
            {{ range .Pages.ByDate }}
            {{ partial "2026/event-card.html" . }}
            {{ end }}
          </div>
        </div>
        {{ end }}
      {{ else }}
      <div class="empty-state">
        <p>No upcoming events scheduled right now.</p>
        <p>Join our <a href="{{ .Site.Params.discord_url }}">Discord</a> to be the first to know when new events are announced!</p>
      </div>
      {{ end }}
    </section>

    {{ if $past }}
    <section class="events-list-section">
      <h2>Past Events</h2>
      {{ range $past.GroupByDate "January 2006" "desc" }}
      <div class="events-month">
        <h3 class="events-month__title">{{ .Key }}</h3>
        <div class="events-grid">
          {{ range .Pages }}
          {{ partial "2026/event-card.html" . }}
          {{ end }}
        </div>
      </div>
      {{ end }}
    </section>
    {{ end }}

  </div>
</div>

{{ end }}
