BEGIN:VCALENDAR{{ "\r\n" -}}
VERSION:2.0{{ "\r\n" -}}
PRODID:-//Tas Game Makers//Events//EN{{ "\r\n" -}}
CALSCALE:GREGORIAN{{ "\r\n" -}}
METHOD:PUBLISH{{ "\r\n" -}}
X-WR-CALNAME:Tas Game Makers Events{{ "\r\n" -}}
X-WR-TIMEZONE:Australia/Hobart{{ "\r\n" -}}
REFRESH-INTERVAL;VALUE=DURATION:PT1H{{ "\r\n" -}}
X-PUBLISHED-TTL:PT1H{{ "\r\n" -}}
{{ range .Pages -}}
{{- $title := printf "Tas Game Makers: %s" .Title -}}
{{- $title = replace $title "\\" "\\\\" -}}
{{- $title = replace $title ";" "\\;" -}}
{{- $title = replace $title "," "\\," -}}
{{- $title = replace $title "\r" "" -}}
{{- $title = replace $title "\n" "\\n" -}}
{{- $desc := .Params.summary | default .Title -}}
{{- $desc = replace $desc "\\" "\\\\" -}}
{{- $desc = replace $desc ";" "\\;" -}}
{{- $desc = replace $desc "," "\\," -}}
{{- $desc = replace $desc "\r" "" -}}
{{- $desc = replace $desc "\n" "\\n" -}}
BEGIN:VEVENT{{ "\r\n" -}}
UID:{{ .Permalink }}{{ "\r\n" -}}
DTSTAMP:{{ now.UTC.Format "20060102T150405Z" }}{{ "\r\n" -}}
DTSTART:{{ .Date.UTC.Format "20060102T150405Z" }}{{ "\r\n" -}}
{{ with .Params.end_date -}}
DTEND:{{ (time .).UTC.Format "20060102T150405Z" }}{{ "\r\n" -}}
{{ end -}}
SUMMARY:{{ $title }}{{ "\r\n" -}}
DESCRIPTION:{{ $desc }}{{ "\r\n" -}}
{{ with .Params.location -}}
{{- $loc := replace . "\\" "\\\\" -}}
{{- $loc = replace $loc ";" "\\;" -}}
{{- $loc = replace $loc "," "\\," -}}
{{- $loc = replace $loc "\r" "" -}}
{{- $loc = replace $loc "\n" "\\n" -}}
LOCATION:{{ $loc }}{{ "\r\n" -}}
{{ end -}}
URL:{{ .Permalink }}{{ "\r\n" -}}
STATUS:CONFIRMED{{ "\r\n" -}}
END:VEVENT{{ "\r\n" -}}
{{ end -}}
END:VCALENDAR{{ "\r\n" -}}
